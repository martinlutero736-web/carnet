<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Sistema Corporativo de Carnetizaci贸n</title>
  <link rel="stylesheet" href="style.css">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">


</head>
<body>

  <div class="card">

    <div class="header">
      <img src="logo.png" class="logo">
      <h1>Sistema Corporativo de Carnetizaci贸n</h1>
      <p>Diligencie la informaci贸n de manera correcta para continuar el proceso.</p>
    </div>

    <div class="divider"></div>

    <form id="formCarnet">

      <div class="form-group">
        <label>C贸digo asignado</label>
        <input type="number" id="codigo" required>
      </div>

      <div class="form-group">
        <label>Nombre de contacto de emergencia</label>
        <input type="text" id="contacto_emergencia" required>
      </div>

      <div class="form-group">
        <label>N煤mero de contacto</label>
        <input type="tel" id="numero_contacto_emergencia" required>
      </div>

      <div class="form-group">
        <label>Discapacidad</label>
        <select id="discapacidad" required>
          <option value="">Seleccione</option>
          <option>No</option>
          <option>F铆sica</option>
          <option>Visual</option>
          <option>Auditiva</option>
          <option>Otra</option>
        </select>
      </div>

      <div class="form-group">
        <label>Tipo de sangre (RH)</label>
        <select id="rh" required>
          <option value="">Seleccione</option>
          <option>O+</option>
          <option>O-</option>
          <option>A+</option>
          <option>A-</option>
          <option>B+</option>
          <option>B-</option>
          <option>AB+</option>
          <option>AB-</option>
        </select>
      </div>

      <button type="submit" id="btnEnviar">Enviar Informaci贸n</button>
      <div class="status" id="status"></div>

    </form>
    >
    <div class="footer">
      漏 2026 Sistema Institucional - Todos los derechos reservados
    </div>

  </div>

<script type="module">

  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
  import { getFirestore, collection, addDoc, serverTimestamp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyAN7r2zY3Csw5lheRPtOUFweT-aAI8QLoE",
    authDomain: "carnetizacion-997a8.firebaseapp.com",
    projectId: "carnetizacion-997a8",
    storageBucket: "carnetizacion-997a8.firebasestorage.app",
    messagingSenderId: "13508799346",
    appId: "1:13508799346:web:5564ed17ab1b54a8408beb"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  const form = document.getElementById("formCarnet");
  const status = document.getElementById("status");
  const btn = document.getElementById("btnEnviar");

  form.addEventListener("submit", async (e) => {
    e.preventDefault();

    btn.classList.add("loading");
    btn.innerText = "Procesando...";
    btn.disabled = true;

    try {

      //  Generar ID 煤nico de pago
      const paymentId = "CARNET-" + Date.now();

      //  Guardar en Firestore
      await addDoc(collection(db, "registros"), {
        codigo: Number(document.getElementById("codigo").value),
        contacto_emergencia: document.getElementById("contacto_emergencia").value,
        numero_contacto_emergencia: document.getElementById("numero_contacto_emergencia").value,
        discapacidad: document.getElementById("discapacidad").value,
        rh: document.getElementById("rh").value,
        paymentId: paymentId,
        pagoConfirmado: false,
        fecha: serverTimestamp()
      });

      //  Redirigir autom谩ticamente a Bold
      window.location.href = `https://checkout.bold.co/payment/LNK_LCF389J863?reference=${paymentId}`;


    } catch (error) {

      console.error(error);
      status.style.color = "red";
      status.innerText = "Error al enviar la informaci贸n.";
      btn.classList.remove("loading");
      btn.innerText = "Enviar Informaci贸n";
      btn.disabled = false;

    }

  });

</script>

</body>
</html>
 